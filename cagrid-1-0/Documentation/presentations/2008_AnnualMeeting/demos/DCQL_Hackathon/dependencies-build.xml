<?xml version="1.0"?>

<project name="dependencies" basedir="." xmlns:ivy="antlib:org.apache.ivy.ant">
	<!-- properties can be overridden by setting values in project.properties -->
	<property file="project.properties" />
	
	<!-- import the master build -->
	<import file="build.xml" />
	<!-- define the Ivy ant tasks -->
	<taskdef resource="org/apache/ivy/ant/antlib.xml" uri="antlib:org.apache.ivy.ant">
		<classpath>
			<fileset dir="${ivy.lib.dir}" includes="ivy-*.jar" />
		</classpath>
	</taskdef>

	<!-- resolve dependencies from remote caGrid Ivy repository -->
	<property name="ivy.settings.url" value="http://software.cagrid.org/repository-1.2/ivysettings.xml" />
	<ivy:settings id="ivy.instance" url="${ivy.settings.url}" override="true" />
	
	<target name="ivy-resolve" description="--> retreive dependencies with ivy">
		<!--
		<ivy:retrieve type="jar" />
		-->
		<ivy:retrieve conf="default" pattern="${lib.dir}/[artifact](.[ext])" sync="true" type="jar" />
	</target>

	<target name="ivy-report" depends="ivy-resolve" description="--> generates a report of dependencies">
		<ivy:report todir="${build.dir}" />
	</target>

	<target name="ivy-clean" description="--> cleans all the libraries which were retrieved for the project">
		<delete includeemptydirs="true" failonerror="false">
			<fileset dir="${lib.dir}">
				<include name="**/*" />
			</fileset>
		</delete>
		<ivy:cleancache />
	</target>
	<target name="all" depends="ivy-clean,ivy-resolve,ivy-report" />
</project>

