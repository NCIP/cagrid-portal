<!-- ======================================================================= -->
<!-- caGrid Custom Ant Tasks build file                                      -->
<!-- ======================================================================= -->
<project name="caGrid_ant_tasks" basedir="." default="">

    <path id="ant.tasks.classpath">
        <pathelement location="${anttask.classes.dir}" />
        <fileset dir="${ant.library.dir}">
            <include name="ant.jar" />
        </fileset>
        <fileset dir="${share.lib.dir}">
            <include name="ant-contrib*.jar" />
        </fileset>
    </path>

    <target name="check-anttask-rebuild-needed">
        <condition property="have.anttasks">
            <and>
                <available classname="gov.nih.nci.cagrid.ant.Artifact">
                    <classpath refid="ant.tasks.classpath" />
                </available>
                <available classname="gov.nih.nci.cagrid.ant.ResolveDependencies">
                    <classpath refid="ant.tasks.classpath" />
                </available>
            </and>
        </condition>
    </target>

    <target name="build-ant-tasks" unless="have.anttasks" depends="check-anttask-rebuild-needed">
        <delete dir="${anttask.classes.dir}" />
        <mkdir dir="${anttask.classes.dir}" />
        <javac srcdir="${antfiles.dir}/src" destdir="${anttask.classes.dir}" debug="on" deprecation="off" optimize="off">
            <classpath refid="ant.tasks.classpath" />
        </javac>
    </target>

    <target name="define-ant-tasks" unless="defined.anttasks" depends="build-ant-tasks">
        <taskdef resource="net/sf/antcontrib/antlib.xml" loaderref="artifact">
            <classpath refid="ant.tasks.classpath" />
        </taskdef>
        <typedef name="artifact" classname="gov.nih.nci.cagrid.ant.Artifact" loaderref="artifact">
            <classpath refid="ant.tasks.classpath" />
        </typedef>
        <taskdef name="resolveDependencies" classname="gov.nih.nci.cagrid.ant.ResolveDependencies" loaderref="artifact">
            <classpath refid="ant.tasks.classpath" />
        </taskdef>
        <property name="defined.anttasks" value="true" />
    </target>

</project>
