<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
	<bean id="database" class="org.cagrid.tools.database.Database">
		<constructor-arg index="0" value="${gaards.cds.db.host}" />
		<constructor-arg index="1" value="${gaards.cds.db.port}" />
		<constructor-arg index="2" value="${gaards.cds.db.user}" />
		<constructor-arg index="3" value="${gaards.cds.db.password}" />
		<constructor-arg index="4" value="${gaards.cds.name}" />
	</bean>

	<!-- ADD POLICY HANDLER BEANS HERE -->

	<bean id="identityPolicyHandler"
		class="org.cagrid.gaards.cds.service.IdentityPolicyHandler">
		<constructor-arg index="0" ref="database" />
	</bean>

	<bean id="propertyManager"
		class="org.cagrid.gaards.cds.service.PropertyManager">
		<constructor-arg index="0" ref="database" />
	</bean>

	<bean id="proxyPolicy"
		class="org.cagrid.gaards.cds.service.ProxyPolicy">
		<property name="supportedKeySizes">
			<set>
				<value>1024</value>
				<value>2048</value>
			</set>
		</property>
	</bean>

	<bean id="keyManager"
		class="org.cagrid.gaards.cds.service.DBKeyManager">
		<constructor-arg index="0" ref="database" />
		<property name="keyEncryptionPassword"
			value="${gaards.cds.dbkeymanager.key.encyption.password}" />
	</bean>

	<bean id="delegatedCredentialManager"
		class="org.cagrid.gaards.cds.service.DelegatedCredentialManager">
		<constructor-arg index="0" ref="database" />
		<constructor-arg index="1" ref="propertyManager" />
		<constructor-arg index="2" ref="keyManager" />
		<constructor-arg index="3">
			<list>
				<ref bean="identityPolicyHandler"/>
			</list>
		</constructor-arg>
		<constructor-arg index="4" ref="proxyPolicy" />
	</bean>


</beans>