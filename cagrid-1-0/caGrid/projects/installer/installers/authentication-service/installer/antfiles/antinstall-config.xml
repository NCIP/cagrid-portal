<?xml version="1.0"?>
<!DOCTYPE installer PUBLIC "-//tp23 //DTD Ant Installer Config//EN" "http://antinstaller.sf.net/dtd/antinstall-config-0.7.dtd">




<installer ui="swing,text" verbose="false" lookAndFeel="com.jgoodies.plaf.plastic.Plastic3DLookAndFeel" name="caGrid Installer" windowIcon="/resources/gkmain_inv.png" defaultImageResource="/resources/caGrid.jpg" minJavaVersion="1.4">
<!--  each page element represents a page of the installer -->
   
			
    <page type="input" name="P1" displayText="Welcome to Authentication Service Installation and configuration" 
        		imageResource="/resources/caGrid.jpg"
        		>
        		
            <select
			property="target.container"
			defaultValue="tomcat"
			displayText="Choose the target container">
		<option text="Tomcat" value="tomcat"/>
		<option text="Globus" value="globus"/>
	    				
		</select>
            
            
    </page>
    
    
    <page type="input" 
    	  name="P2" 
    	  displayText="Checking Tomcat" 	
    	  imageResource="/resources/caGrid.jpg"
    	  ifProperty="${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('false')">
    	
    	<comment displayText="Checking Tomcat" bold="true" />	
    	<comment displayText="Tomcat is not found. Make sure Tomcat is installed and CATALINA_HOME is set" bold="true" />
    </page>
    
    
    <page  type="input" 
    	   name="P3" 
    	   displayText="Checking Globus" 
    	   ifProperty="${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('false')">
        
        <comment displayText="Checking Globus" bold="true" />
        <comment displayText="Globus is not found. Make sure Globus is installed and GLOBUS_LOCATION is set" bold="true" />

    </page>
    
    <!--*************************************************************************
        *************************************************************************
                       Input for certificate and key
        *************************************************************************
        *************************************************************************-->
    <page  type="input" name="P_cert_1" displayText="This certificate will be used to sign SAML" ifProperty="(${target.container}.equalsIgnoreCase('tomcat'))**(${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus'))**(${gridenv.globus.exist}.equalsIgnoreCase('true'))">
        <comment displayText="Do you have a self signed certificate and key" bold="true" />
        
        <comment displayText="A self signed certificate is needed" bold="true" />
        <select
					property="ca.exist"
					defaultValue="false"
					displayText="Do you have self signed certificate and key?">
				<option text="Yes, I Have" value="true"/>
				<option text="No, I don't" value="false"/>
				
		</select>
    </page>
    
    
    <page  type="input" name="P_cert_3" displayText="Following information is needed to create a certificate to sign SAML" ifProperty="((${target.container}.equalsIgnoreCase('tomcat'))**(${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus'))**(${gridenv.globus.exist}.equalsIgnoreCase('true')))**(${ca.exist}.equalsIgnoreCase('false'))">
                <comment displayText="Provide following information" bold="true" />
                
            <text property="ca.o" displayText="CA organization" defaultValue="" explanatoryText="Name of the organization e.g NIH or NCI" />
            <text property="ca.ou" displayText="CA organizational Unit" defaultValue="" explanatoryText="Name of the organization Unit" />
            <text property="ca.cn" displayText="CA common name" defaultValue="" explanatoryText="Common name for certificate authority" />
            <text property="ca.dv" displayText="Days valid to" defaultValue="" explanatoryText="Certificate authority is valid only for a limited time. Enter the number of days"/>
            <text property="ca.keypwd" displayText="CA key password" defaultValue="" />
            <directory property="root.cert.location" defaultValue="${gridenv.user.local.home}/cagrid-1-0/certificates" defaultValueWin="${gridenv.user.local.home}/cagrid-1-0/certificates" displayText="Root certificate location" create="true" />
                <directory property="root.key.location" defaultValue="${gridenv.user.local.home}/cagrid-1-0/certificates" defaultValueWin="${gridenv.user.local.home}/cagrid-1-0/certificates" displayText="Root key location" create="true" />

                
    </page>
    
    <page  type="input" name="P_cert_4" displayText="Certificate to be generated to sign SAML" ifProperty="((${target.container}.equalsIgnoreCase('tomcat'))**(${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus'))**(${gridenv.globus.exist}.equalsIgnoreCase('true')))**(${ca.exist}.equalsIgnoreCase('true'))">
                    <comment displayText="Provide following information about the certificate" bold="true" />
                
                <file property="host.cert" defaultValue="${gridenv.user.local.home}/cagrid-1-0/certificates" defaultValueWin="${gridenv.user.local.home}/cagrid-1-0/certificates" displayText="CA Certificate" checkExists="true"/>
                <file property="host.key" defaultValue="${gridenv.user.local.home}/cagrid-1-0/certificates" defaultValueWin="${gridenv.user.local.home}/cagrid-1-0/certificates" displayText="CA Key" checkExists="true"/>
	        <text property="ca.keypwd" displayText="CA key password" defaultValue="" />
                
                
                    
    </page>
    
   
   
   <!--*************************************************************************
       *************************************************************************
                     End of Input for certificate and key
       *************************************************************************
       *************************************************************************-->
        
    
    <page type="input" name="P4_A" displayText="Type of credential provider" 
            		imageResource="/resources/caGrid.jpg"
            		ifProperty="(${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('true'))" >
            		
                <select
    			property="credential.provider"
    			defaultValue="rdbms"
    			displayText="Choose the type of credential provider">
    		<option text="RDBMS" value="rdbms"/>
    		<option text="LDAP" value="ldap"/>
    	    				
    		</select>
                
                
    </page>
    
    <page type="input" name="P4_A_1" displayText="RDBMS credential provider" 
                		imageResource="/resources/caGrid.jpg"
                		ifProperty="((${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('true')))**(${credential.provider}.equalsIgnoreCase('rdbms'))" >
                		
	    <text property="credential.provider.rdbms.data.base.driver" 
		  displayText="Database driver" 
		  defaultValue="" 
	          explanatoryText="The name of the service by which it will be displayed" />
	    
	    <file property="credential.provider.rdbms.data.base.driver.jar.or.zip.file" defaultValue="" defaultValueWin="" displayText="Driver Jar" checkExists="true"/>
	    <text property="credential.provider.rdbms.data.base.url" 
	    		  displayText="Database URL" 
	    		  defaultValue="" 
	    	          explanatoryText="The name of the service by which it will be displayed" />
	     <text property="credential.provider.rdbms.user.id" 
	     		  displayText="Database user id" 
	     		  defaultValue="" 
	     	          explanatoryText="The name of the service by which it will be displayed" />
	      <text property="credential.provider.rdbms.password" 
	      		  displayText="Database password" 
	      		  defaultValue="" 
	      	          explanatoryText="The name of the service by which it will be displayed" />
	     <text property="credential.provider.rdbms.data.base.table.name" 
	     		  displayText="Table Name" 
	     		  defaultValue="" 
	     	          explanatoryText="The name of the service by which it will be displayed" />
	    <text property="credential.provider.rdbms.user.id.column.name" 
	    		  displayText="User Id column name" 
	    		  defaultValue="" 
	    	          explanatoryText="The name of the service by which it will be displayed" />
	    <text property="credential.provider.rdbms.password.column.name" 
			  displayText="Password column name" 
			  defaultValue="" 
			  explanatoryText="The name of the service by which it will be displayed" />
	    <text property="credential.provider.rdbms.user.first.name.column.name" 
			  displayText="First Name column name" 
			  defaultValue="" 
			  explanatoryText="The name of the service by which it will be displayed" />
	     <text property="credential.provider.rdbms.last.name.column.name" 
	    		  displayText="Last Name column name" 
	    		  defaultValue="" 
	    	          explanatoryText="The name of the service by which it will be displayed" />

	     <text property="credential.provider.rdbms.email.id.column.name" 
	    		  displayText="Email Id column name" 
	    		  defaultValue="" 
	    	          explanatoryText="The name of the service by which it will be displayed" />
        
    </page>
    
    <page type="input" name="P4_A_2" displayText="LDAP credential provider" 
                    		imageResource="/resources/caGrid.jpg"
                    		ifProperty="((${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('true')))**(${credential.provider}.equalsIgnoreCase('ldap'))" >
                    		
    	    <text property="credential.provider.ldap.host" 
    		  displayText="LDAP Host" 
    		  defaultValue="" 
    	          explanatoryText="The name of the service by which it will be displayed" />
    	    <text property="credential.provider.ldap.search.base" 
    	    		  displayText="Searchable Base" 
    	    		  defaultValue="" 
    	    	          explanatoryText="The name of the service by which it will be displayed" />
    	    <text property="credential.provider.ldap.user.id.label" 
    	    		  displayText="User Id Label" 
    	    		  defaultValue="" 
    	    	          explanatoryText="The name of the service by which it will be displayed" />
    	     <text property="credential.provider.ldap.admin.name" 
    	     		  displayText="Admin name" 
    	     		  defaultValue="" 
    	     	          explanatoryText="The name of the service by which it will be displayed" />
    	      <text property="credential.provider.ldap.admin.password" 
    	      		  displayText="Admin password" 
    	      		  defaultValue="" 
    	      	          explanatoryText="The name of the service by which it will be displayed" />
    	     <text property="credential.provider.ldap.user.first.name" 
    	     		  displayText="User First Name" 
    	     		  defaultValue="" 
    	     	          explanatoryText="The name of the service by which it will be displayed" />
    	     <text property="credential.provider.ldap.user.last.name" 
			  displayText="User Last Name" 
			  defaultValue="" 
	  		  explanatoryText="The name of the service by which it will be displayed" />
    	    <text property="credential.provider.ldap.user.email.id" 
    	    		  displayText="User Email Id" 
    	    		  defaultValue="" 
    	    	          explanatoryText="The name of the service by which it will be displayed" />
    	    
    </page>
    
    
        
    <page  type="input" name="P5" displayText="Service Metadata configuration" ifProperty="(${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('true'))">
                <comment displayText="Provide Resreach Centre information" bold="true" />
                
                <text property="authservice.service.display.name" 
                      displayText="Display Name" 
                      defaultValue="${gridenv.authservice.service.display.name}" 
                      explanatoryText="The name of the service by which it will be displayed" />
                      
                <text property="authservice.service.short.name" 
                      displayText="Short Name" 
                      defaultValue="${gridenv.authservice.service.short.name}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.country" 
                      displayText="Country" 
                      defaultValue="${gridenv.authservice.service.country}" />
                      
                <text property="authservice.service.postal.code" 
                      displayText="Postal Code" 
                      defaultValue="${gridenv.authservice.service.postal.code}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.province" 
                      displayText="Province" 
                      defaultValue="${gridenv.authservice.service.province}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.street" 
                      displayText="Street" 
                      defaultValue="${gridenv.authservice.service.street}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.rc.affiliation" 
                      displayText="Affiliation" 
                      defaultValue="${gridenv.authservice.service.rc.affiliation}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.rc.poc.email" 
                      displayText="Poc's Email" 
                      defaultValue="${gridenv.authservice.service.rc.poc.email}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.rc.poc.first.name" 
                      displayText="First Name" 
                      defaultValue="${gridenv.authservice.service.rc.poc.first.name}"
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.rc.poc.last.name" 
                      displayText="Last Name" 
                      defaultValue="${gridenv.authservice.service.rc.poc.last.name}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
                <text property="authservice.service.rc.poc.role" 
                      displayText="Role" 
                      defaultValue="${gridenv.authservice.service.rc.poc.role}" 
                      explanatoryText="The name of the service by which it will be displayed"/>
                      
      </page>
    <page  type="input" name="P6" displayText="Service Metadata configuration" ifProperty="(${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('true'))">
                <comment displayText="Provide Point of contact information" bold="true" />
                
            <text property="authservice.service.poc.affiliation" 
                  displayText="Affiliation" 
                  defaultValue="${gridenv.authservice.service.poc.affiliation}" 
                  explanatoryText="The name of the service by which it will be displayed"/>
	    <text property="authservice.service.poc.email" 
	          displayText="Poc's Email" 
	          defaultValue="${gridenv.authservice.service.poc.email}" 
	          explanatoryText="The name of the service by which it will be displayed"/>
	    <text property="authservice.service.poc.first.name" 
	          displayText="First Name" 
	          defaultValue="${gridenv.authservice.service.poc.first.name}" 
	          explanatoryText="The name of the service by which it will be displayed"/>
	    <text property="authservice.service.poc.last.name" 
	          displayText="Last Name" 
	          defaultValue="${gridenv.authservice.service.poc.last.name}" 
	          explanatoryText="The name of the service by which it will be displayed"/>
	    <text property="authservice.service.poc.role" 
	          displayText="Role" 
	          defaultValue="${gridenv.authservice.service.poc.role}" 
	          explanatoryText="The name of the service by which it will be displayed"/>


                
    </page>
    
    
    <page type="deployproperty" 
              name="P_ABC" 
              displayText="Deploy property page" 
              imageResource="/resources/caGrid.jpg"
              ifProperty="(${target.container}.equalsIgnoreCase('tomcat')**${gridenv.tomcat.exist}.equalsIgnoreCase('true'))||(${target.container}.equalsIgnoreCase('globus')**${gridenv.globus.exist}.equalsIgnoreCase('true'))">
    </page>
    
    
    
    <page type="input" name="selector" displayText="Components to install">
        <comment displayText="The following components will be installed" bold="true" />
        <target displayText="Authentication Service" target="installAuthenticationService" defaultValue="true" force="true" />
        <target displayText="Source Code" target="installsource" defaultValue="false" force="false" />
    </page>
<!--  These are some other input types -->
<!--  page type="progress" shows a progress page with the install button 
                Its target is set to cleanuptarget since it is the last page this target will be run last-->
    <page type="progress" name="progress" showTargets="true" displayText="Installation progress" target="finished">
    </page>
</installer>
