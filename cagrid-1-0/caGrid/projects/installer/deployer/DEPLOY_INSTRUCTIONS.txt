#########
# Setup #
#########

Place tomcat and globus zip files in software subdirectory.
Configure <target_env>.properties as required.

#############
# Re-deploy #
#############

Run: ant redeploy

################
# Fresh Deploy #
################

1. Run: ant initialize
2. Copy certs to local trust store:

	scp globus@<host>:<path_to_installer_dir>/certs/DORIAN_CA_CERT.pem \
	~/.globus/certificates/DORIAN_CA_CERT.0
	
	scp globus@<host>:<path_to_installer_dir>/certs/GTS_CA_CERT.pem \
	~/.globus/certificates/GTS_CA_CERT.0
	
	scp globus@<host>:<path_to_installer_dir>/certs/NCI_ROOT_CA_CERT.pem \
	~/.globus/certificates/NCI_ROOT_CA_CERT.0
	
	scp globus@<host>:<path_to_installer_dir>/certs/AUTHNSVC_CA_CERT.pem \
	~/.globus/certificates/AUTHNSVC_CA_CERT.0
	
2. Run: ant deploy-nodes
3. Run: ant startup-tomcats
4. Create Dorian manager:

	a. Bring up Security UI
	b. Log into Dorian IdP as dorian
	c. Request manager account
	b. Approve manager account
	d. Log into Dorian IdP as manager

5. Create AuthSvc IdP

	a. Import AUTHNSVC_CA_CERT.0
	b. Set IdP name to "AuthnSvc IdP"
	c. Check "Password" as "Accepted Authentcation Method"
	d. Select "Auto Approval / Auto Renewal" as "User Policy"
	e. Click "Add"
	
6. Configure GTS Services

	In Master GTS:
		a. Create "Service CAs" and "User CAs" trust levels.
		b. Import NCI_ROOT_CA_CERT.0 and set trust level to "Service CAs".
		c. Import DORIAN_CA_CERT.0 and set trust level to "User CAs".
		d. Add permission:
	
			Grid Identity: /O=NIH/OU=NCI/OU=NCICB/OU=caBIG Service Group/CN=host/<node3.host>.nci.nih.gov
			Trusted Authority: O=NIH,OU=NCI,OU=NCICB,OU=caBIG User Group,CN=caBIG Dorian CA
			Role: TrustAuthorityManager
			
	In Slave GTS:
		Add authority:
		
			GTS URI: https://<node4.host>.nci.nih.gov:8443/wsrf/services/cagrid/GTS
			Priority: 1
			Synchronize Trust Levels: true
			Perform Authorization: true
			Authorization Identity: /O=NIH/OU=NCI/OU=NCICB/OU=caBIG Trust Group/CN=host/<node4.host>.nci.nih.gov
			Hours: 1

7. Run: ant shutdown-tomcats
8. Run: ant deploy-syncgts-services
9. Run: ant startup-tomcats
