<!-- ======================================================================= -->
<!-- caGrid Analytical Utilities build file                                  -->
<!-- ======================================================================= -->
<project name="introduce_release" basedir="." default="usage">
	
	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<pathelement location="${basedir}/lib/ant-contrib.jar" />
		</classpath>
	</taskdef>
	
	<property name="introduce.extension.projects.list" value="cabigextensions, cadsr, data, bulkDataTransfer" />
	<property name="introduce.extensions.dir" value="${basedir}/tmp/extensions" />
	
	
	<!-- ============================================================== -->
	<!-- Installs the Introduce Extensions                              -->
	<!-- ============================================================== -->
	<target name="releaseIntroduceExtensions" depends="prepare">
		<mkdir dir="tmp"/>
		<for list="${introduce.extension.projects.list}" parallel="true" param="project.name" trim="true">
			<sequential>
				<echo message="Installing Introduce Extensions from @{project.name}." />
				<ant dir="${basedir}/../@{project.name}" inheritAll="false" antfile="build.xml" target="installIntroduceExtensions">
					<property name="introduce.extensions.dir" value="${introduce.extensions.dir}/@{project.name}" />
				</ant>
			</sequential>
		</for>
	</target>
	
	<!-- =================================================================== -->
	<!-- Builds the project and the docs for a release                       -->
	<!-- =================================================================== -->
	<target name="release" description="Cleans and build the entire application and the docs etc" depends="clean,all,javadoc,releaseIntroduceExtensions,createInstaller"/>
	
	<!-- Allows us to use the IzPack Ant task -->
	<taskdef name="izpack" classpath="${basedir}/install/standalone-compiler.jar"
		classname="com.izforge.izpack.ant.IzPackTask"/>
	
	<!-- =================================================================== -->
	<!-- Creates the installer                                               -->
	<!-- =================================================================== -->
	<target name="createInstaller" description="Creates the installler" depends="">
		<delete dir="tmp/installer"/>
		<mkdir dir="tmp/installer"/>
		<izpack input="${basedir}/install/install.xml"
			output="tmp/installer/Introduce-RC1.0-installer.jar"
			installerType="web"
			basedir="."
			izPackDir="${basedir}/install"/>
	</target>
	
</project>
