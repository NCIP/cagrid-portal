package gov.nih.nci.cagrid.workflow.service;

import gov.nih.nci.cagrid.common.Utils;
import gov.nih.nci.cagrid.workflow.context.service.globus.resource.WorkflowServiceHome;
import gov.nih.nci.cagrid.workflow.stubs.types.WMSInputType;
import gov.nih.nci.cagrid.workflow.stubs.types.WMSOutputType;
import gov.nih.nci.cagrid.workflow.stubs.types.WSDLReferences;

import java.io.File;
import java.rmi.RemoteException;

import javax.naming.Context;
import javax.naming.InitialContext;

import org.globus.wsrf.Constants;
import org.globus.wsrf.impl.SimpleResourceKey;


/** 
 *  TODO:DOCUMENT ME
 * 
 * @created by Introduce Toolkit version 1.0
 * 
 */
public class WorkflowFactoryServiceImpl extends WorkflowFactoryServiceImplBase {

	public static String BPEL_EXTENSION = ".bpel";
	
	protected String abAdminRoot = "http://localhost:8080/active-bpel/services/";
	
	public WorkflowFactoryServiceImpl() throws RemoteException {
		super();
	}
	

	public WMSOutputType createWorkflow(WMSInputType wMSInputElement) throws RemoteException, gov.nih.nci.cagrid.workflow.stubs.types.WorkflowExceptionType {
		//TODO: Implement this autogenerated method
		WMSOutputType output = new WMSOutputType();
		WorkflowServiceHome workflowHome = null;
		SimpleResourceKey key = null;
		try {
			Context ctx = new InitialContext();
			String lookupString = Constants.JNDI_SERVICES_BASE_NAME 
				+ "cagrid/WorkflowServiceImpl" + "/home";
			System.out.println("Context String : " + lookupString);
			workflowHome = (WorkflowServiceHome) ctx.lookup(lookupString);
			
			key = workflowHome.create(null, wMSInputElement);
		} catch (Exception e){
			throw new RemoteException ("Exception deploying workflow:" ,e );
		}
		return output;
	}

}

