<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
    <bean id="csmPDP" class="gov.nih.nci.cagrid.authorization.impl.CSMPDP">
        <property name="authorizationManager">
            <bean class="gov.nih.nci.security.SecurityServiceProvider"
                factory-method="getAuthorizationManager">
                <constructor-arg value="myapp"/>
            </bean>
        </property>
        <property name="selectorSelector" ref="selectorSelector"/>
    </bean>
    <bean id="selectorSelector" class="gov.nih.nci.cagrid.authorization.impl.OperationPENodeSelectorSelector">
        <property name="mappings">
            <list>
                <bean class="gov.nih.nci.cagrid.authorization.impl.RegExPENodeSelectorMapping">
                    <property name="pattern" value=".*createResource"/>
                    <property name="selector" ref="createResource"/>
                </bean>
                <bean class="gov.nih.nci.cagrid.authorization.impl.RegExPENodeSelectorMapping">
                    <property name="pattern" value=".*ChatSessionService.*"/>
                    <property name="selector" ref="instanceService"/>
                </bean>
                <bean class="gov.nih.nci.cagrid.authorization.impl.RegExPENodeSelectorMapping">
                    <property name="pattern" value=".*ChatSessionFactoryService.*"/>
                    <property name="selector" ref="factoryService"/>
                </bean>
            </list>
        </property>
    </bean>
    <bean id="createResource" class="gov.nih.nci.cagrid.authorization.impl.ConstantPENodeSelector">
        <property name="privilege" value="EXECUTE"></property>
        <property name="objectId" value="{http://cagrid.nci.nih.gov/chat/ChatSessionFactoryService}createResource"/>
    </bean>
    <bean id="instanceService" class="gov.nih.nci.cagrid.authorization.impl.ConstantPENodeSelector">
        <property name="privilege" value="ACCESS"></property>
        <property name="objectId" value="http://cagrid.nci.nih.gov/chat/ChatSessionService"/>
    </bean>
    <bean id="factoryService" class="gov.nih.nci.cagrid.authorization.impl.ConstantPENodeSelector">
        <property name="privilege" value="ACCESS"></property>
        <property name="objectId" value="http://cagrid.nci.nih.gov/chat/ChatSessionFactoryService"/>
    </bean>
    
</beans>