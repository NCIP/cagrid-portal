<?xml version="1.0"?>

<project name="cagrid-portal-common" basedir=".">

    <property name="target.env" value="local"/>

    <dirname property="antfiles.dir" file="${ant.file.cagrid-portal-common}"/>
    <property name="projects.dir" value="${antfiles.dir}/.."/>
    <property name="tools.ant.lib" value="${projects.dir}/tools/ant/lib"/>

    <property name="target.property.file" value="${projects.dir}/build-${target.env}.properties"/>
    <property file="${target.property.file}"/>
    <property file="${projects.dir}/build.properties"/>
    <property file="${antfiles.dir}/project.properties"/>


    <target name="prepare-ant-tasks" unless="defined.anttaskes">
        <path id="xmltaskdef.cp">
            <pathelement location="${tools.ant.lib}/xmltask-v1.14.jar"/>
        </path>

        <taskdef name="xmltask"
                 classname="com.oopsconsultancy.xmltask.ant.XmlTask"
                 classpathref="xmltaskdef.cp"/>

        <taskdef resource="net/sf/antcontrib/antlib.xml">
            <classpath>
                <fileset dir="${tools.ant.lib}">
                    <include name="ant-contrib*.jar"/>
                </fileset>
            </classpath>
        </taskdef>

        <property name="defined.anttasks" value="true"/>

    </target>

    <target name="create-cagridportal-properties">
        <fail message="Please specify a target directory">
            <condition>
                <not>
                    <isset property="target.dir"/>
                </not>
            </condition>
        </fail>

        <mkdir dir="${target.dir}"/>
        <delete file="${target.dir}/cagridportal.properties" failonerror="false"/>

        <propertyfile file="${target.dir}/cagridportal.properties"
                      comment="Auto-generated by cagridportal build.">
            <entry key="cagrid.portal.db.url" value="${cagrid.portal.db.url}"/>
            <entry key="cagrid.portal.db.username" value="${cagrid.portal.db.username}"/>
            <entry key="cagrid.portal.db.password" value="${cagrid.portal.db.password}"/>
            <entry key="cagrid.portal.db.dialect" value="${cagrid.portal.db.dialect}"/>
            <entry key="cagrid.portal.db.driver" value="${cagrid.portal.db.driver}"/>
            <entry key="cagrid.portal.db.show_sql" value="${cagrid.portal.db.show_sql}"/>
            <entry key="cagrid.portal.indexServiceUrls" value="${cagrid.portal.indexServiceUrls}"/>
            <entry key="cagrid.portal.geocoder.yahoo.baseUrl" value="${cagrid.portal.geocoder.yahoo.baseUrl}"/>
            <entry key="cagrid.portal.geocoder.yahoo.appId" value="${cagrid.portal.geocoder.yahoo.appId}"/>
            <entry key="cagrid.portal.map.google.baseUrl" value="${cagrid.portal.map.google.baseUrl}"/>
            <entry key="cagrid.portal.map.google.apiKey" value="${cagrid.portal.map.google.apiKey}"/>
            <entry key="cagrid.portal.gmeUrl" value="${cagrid.portal.gmeUrl}"/>
            <entry key="cagrid.portal.cadsrUrl" value="${cagrid.portal.cadsrUrl}"/>
            <entry key="cagrid.portal.security.encryption.key" value="${cagrid.portal.security.encryption.key}"/>
            <entry key="cagrid.portal.admin.email" value="${cagrid.portal.admin.email}"/>
            <entry key="cagrid.portal.ifsUrl" value="${cagrid.portal.ifsUrl}"/>
            <entry key="cagrid.portal.http.port" value="${liferay.http.port}"/>
            <entry key="cagrid.portal.https.port" value="${liferay.https.port}"/>
            <entry key="cagrid.portal.httpRedirect.port" value="${cagrid.portal.httpRedirect.port}"/>
            <entry key="cagrid.portal.httpsRedirect.port" value="${cagrid.portal.httpsRedirect.port}"/>
            <entry key="cagrid.portal.trust.synchronizeEnabled" value="${cagrid.portal.trust.synchronizeEnabled}"/>
            <entry key="fqp.service.url" value="${fqp.service.url}"/>
            <entry key="evs.remoteAPI.url" value="${evs.remoteAPI.url}"/>
            <entry key="strict.index.verification" value="${strict.index.verification}"/>
            <entry key="cagrid.portal.aggr.defaultTimeout" value="${cagrid.portal.aggr.defaultTimeout}"/>
            <entry key="cagrid.portal.aggr.long.defaultTimeout" value="${cagrid.portal.aggr.long.defaultTimeout}"/>
            <entry key="cagrid.portal.aggr.defaultPeriod" value="${cagrid.portal.aggr.defaultPeriod}"/>
            <entry key="cagrid.portal.slow.aggr.defaultPeriod" value="${cagrid.portal.slow.aggr.defaultPeriod}"/>
            <entry key="cagrid.portal.fast.aggr.defaultPeriod" value="${cagrid.portal.fast.aggr.defaultPeriod}"/>
            <entry key="cagrid.portal.maxDowntimeHours" value="${cagrid.portal.maxDowntimeHours}"/>
            <entry key="cagrid.portal.build.stamp" value="${cagrid.portal.build.stamp}"/>
            <entry key="cagrid.portal.authenticationMode" value="${cagrid.portal.authenticationMode}"/>
            <entry key="cagrid.portal.host.cert" value="${cagrid.portal.host.cert}"/>
            <entry key="cagrid.portal.host.key" value="${cagrid.portal.host.key}"/>
            <entry key="cagrid.portal.base.url" value="${cagrid.portal.base.url}"/>
            <entry key="cagrid.portal.notifications.enabled" value="${cagrid.portal.notifications.enabled}"/>
            <entry key="cagrid.portal.notifications.mail.server" value="${cagrid.portal.notifications.mail.server}"/>
            <entry key="cagrid.portal.notifications.mail.address" value="${cagrid.portal.notifications.mail.address}"/>
            <entry key="cagrid.portal.autorun.db.updater" value="${autorun.db.updater}"/>
            <entry key="cagrid.portal.solr.http.url" value="${cagrid.portal.solr.http.url}"/>
            <entry key="cagrid.portal.autopopulate.relationship.types" value="${autopopulate.relationship.types}"/>
            <entry key="cagrid.portal.fast.aggr.defaultDelay" value="${cagrid.portal.fast.aggr.defaultDelay}"/>
            <entry key="cagrid.portal.slow.aggr.defaultDelay" value="${cagrid.portal.slow.aggr.defaultDelay}"/>
            <entry key="cagrid.portal.aggr.defaultDelay" value="${cagrid.portal.aggr.defaultDelay}"/>
            <entry key="cagrid.portal.liferay.companyWebId" value="${cagrid.portal.liferay.companyWebId}"/>
            <entry key="cagrid.portal.liferay.omniUserEmail" value="${cagrid.portal.liferay.omniUserEmail}"/>
            <entry key="cagrid.portal.filestore.path" value="${cagrid.portal.filestore.path}"/>
        </propertyfile>
    </target>


</project>