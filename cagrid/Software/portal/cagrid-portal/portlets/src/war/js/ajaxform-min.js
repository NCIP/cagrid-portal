var CGP_AbstractAjaxForm=Class.create({initialize:function(b,a){this.prefix=b;this.formName=this.prefix+a;this.submitButtonLabel="Submit";this.submitButtonContainerId=this.prefix+"submitButtonContainer";this.cancelButtonLabel="Cancel";this.cancelButtonContainerId=this.prefix+"cancelButtonContainer";this.requiredFieldClass="required";this.autoSetFieldClass="autoSet";this.requiredFieldsPatt="form[name='"+this.formName+"'] :input[class*='"+this.requiredFieldClass+"']";this.autoSetFieldsPatt="form[name='"+this.formName+"'] :input[class*='"+this.autoSetFieldClass+"']";this.isExcludeIdField=false;this.idFieldName="id";this.showCancelButton=true;this.messageClass="message"},render:function(){this.submitButtonId=this.submitButtonContainerId+"_Button";this.cancelButtonId=this.cancelButtonContainerId+"_Button";var a=this;this.submitButton=new YAHOO.widget.Button({label:this.submitButtonLabel,id:this.submitButtonId,container:this.submitButtonContainerId});this.submitButton.on("click",function(b){a.submit()});if(this.showCancelButton){this.cancelButton=new YAHOO.widget.Button({label:this.cancelButtonLabel,id:this.cancelButtonId,container:this.cancelButtonContainerId});this.cancelButton.on("click",function(b){a.cancel()})}this.checkEnableSubmit();this.bindCheckEnabled();this.bindSetField()},submit:function(){alert("Submit!")},cancel:function(){alert("Cancel!")},setField:function(b,a){this.setInputMessage(b,"Set "+b+" with value: "+a)},bindCheckEnabled:function(){var a=this.requiredFieldsPatt;if(this.isExcludeIdField){a=this.requiredFieldsNoIdPatt()}var b=this;jQuery(a).bind("keyup",function(c){b.checkEnableSubmit()})},bindSetField:function(){var a=this.autoSetFieldsPatt;if(this.isExcludeIdField){a=this.autoSetFieldsNoIdPatt()}var b=this;jQuery(this.autoSetFieldsPatt).bind("blur",function(c){b.setField(c.target.name,c.target.value)})},checkEnableSubmit:function(){var a=0;var d=this.requiredFieldsPatt;if(this.isExcludeIdField){d=requiredFieldsNoIdPatt()}var b=jQuery(d).get();for(var c=0;c<b.length;c++){if(jQuery.trim(jQuery(b[c]).val())==""){a++}}if(a>0){this.submitButton.set("disabled",true)}else{this.submitButton.set("disabled",false)}},requiredFieldsNoIdPatt:function(){return this.requiredFieldsPath+"[name!='"+this.idFieldName+"']"},autoSetFieldsNoIdPatt:function(){return this.autoSetFieldsPath+"[name!='"+this.idFieldName+"']"},setInputMessage:function(d,a){var b=jQuery("form[name='"+this.formName+"'] :input[name='"+d+"']");var c=jQuery(b).next("."+this.messageClass);if(a==null){if(c.length>0){jQuery(c).remove()}}else{if(c.length==0){jQuery(b).after("<span class='"+this.messageClass+"'></span>")}jQuery(b).next("."+this.messageClass).html(a==null?"":a)}}});var CGP_BaseAjaxForm=Class.create(CGP_AbstractAjaxForm,{initialize:function($super,c,b,a){$super(c,b);this.mgrName=a;this.cancelUrl=""},setField:function(fieldName,fieldValue){if(!this.errorFlag){var thisObj=this;var setterName="set"+fieldName.substring(0,1).toUpperCase()+fieldName.substring(1,fieldName.length);var toEval=this.mgrName+"."+setterName+"('"+fieldValue+"',{	callback:function(message){		thisObj.setInputMessage('"+fieldName+"', message);		if(message == null){			thisObj.checkEnableSubmit();		}	},	errorHandler:function(errorString, exception){		alert(\"Error setting input '"+fieldName+"': \" + errorString);		this.errorFlag = true;	}});";eval(toEval)}},submit:function(){this.validateThenSubmit(false)},cancel:function(){window.location=this.cancelUrl},validateThenSubmit:function(validated){var thisObj=this;var mgr=eval(this.mgrName);if(!validated){mgr.validate({callback:function(response){thisObj.handleValidateSuccess(response)},errorHandler:function(errorString,exception){thisObj.handleValidateError(errorString,exception)}})}else{mgr.submit({callback:function(response){thisObj.handleSubmitSuccess(response)},errorHandler:function(errorString,exception){thisObj.handleSubmitError(errorString,exception)}})}},handleValidateSuccess:function(a){if(a!=null){alert(a)}else{this.validateThenSubmit(true)}},handleValidateError:function(b,a){alert("Error validating: "+b)},handleSubmitSuccess:function(a){alert("Successfully submitted.")},handleSubmitError:function(b,a){alert("Error saving: "+b)}});